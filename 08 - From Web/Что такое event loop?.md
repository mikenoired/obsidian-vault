---
День: 2024-09-11
url: https://habr.com/ru/articles/762618/
tags:
  - "#Web"
---
Event Loop — это основная концепция, на которой построены многие асинхронные операции в JavaScript, Python и других языках программирования. Сначала рассмотрим простое объяснение, а затем разберёмся с кодом.

### Простое объяснение:

Представь себе, что ты работаешь на кухне шеф-поваром. У тебя есть несколько задач: варить суп, жарить мясо и резать овощи. Эти задачи требуют разного времени, и ты не хочешь ждать, пока одна задача закончится, прежде чем начать следующую. Поэтому, пока суп варится (что занимает время), ты начинаешь резать овощи. Пока овощи нарезаны, ты можешь начать жарить мясо. Когда суп готов, ты переключаешься на него и добавляешь туда овощи. Event Loop работает примерно так же — он управляет задачами, позволяя выполнять другие задачи, пока более медленные задачи (например, запросы к серверу) выполняются в фоновом режиме.

### Как это работает в коде:

#### Пример на JavaScript:

```javascript
console.log("Начало");

setTimeout(() => {
  console.log("Это выполнится позже");
}, 2000);

console.log("Конец");
```

#### Что происходит:

1. **`console.log("Начало")`:** Сразу выводится сообщение "Начало".
2. **`setTimeout(...)`:** Устанавливается таймер на 2 секунды. Но, важный момент, JavaScript не ждёт, пока этот таймер завершится, он продолжает выполнять следующие команды.
3. **`console.log("Конец")`:** Сразу выводится сообщение "Конец".
4. **Через 2 секунды:** Код внутри `setTimeout` выполняется и выводит "Это выполнится позже".

**Event Loop** здесь играет ключевую роль. Он следит за тем, когда задачи, такие как таймеры или запросы, завершатся, и запускает соответствующий код. Пока же основной поток (главная нить исполнения) свободен, он выполняет другие задачи.

#### Пример на Python (с использованием asyncio):

```python
import asyncio

async def main():
    print("Начало")
    
    await asyncio.sleep(2)
    
    print("Это выполнится позже")

print("Конец")

asyncio.run(main())
```

#### Что происходит:

1. **`print("Начало")`:** Сразу выводится сообщение "Начало".
2. **`await asyncio.sleep(2)`:** Программа "засыпает" на 2 секунды, но главное отличие в том, что во время этой паузы, Event Loop может выполнить другие задачи, если они есть.
3. **`print("Это выполнится позже")`:** Через 2 секунды выводится это сообщение.
4. **`print("Конец")`:** Этот код выполняется до вызова `asyncio.run(main())`, что делает его похожим на то, как код в JavaScript выполняется сразу, не дожидаясь завершения асинхронных операций.

### Итог:
Event Loop — это механизм, который позволяет эффективно управлять асинхронными задачами, не блокируя основной поток выполнения программы. Он "циклически" проверяет, есть ли задачи, которые готовы к выполнению, и запускает их, когда приходит время. Это позволяет программам быть более эффективными и отзывчивыми, особенно в контексте обработки множества запросов или длительных операций, таких как работа с сетью.